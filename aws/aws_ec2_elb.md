# Elastic Load Balancer를 활용하여 서버의 트래픽 관리하기

## ELB 사용 장점
- 서비스 중간에라도 EC2의 성능이 부족한 경우 인스턴스를 추가할 수 있다.
- 자동으로 추가하는 방법과 수동으로 추가하는 방법이 있는데 자동 추가 시 조건 도달 시 새로운 인스턴스 자동 생성

## ELB 생성하기
- Application LB로 생성
- 사용하고 있는 EC2 인스턴스와 동일한 보안그룹으로 설정
- 라우팅 구성
    - ELB에서 EC2로 연결되는 부분
    - 알맞는 그룹을 추가해서 설정
        - 실습 땐 HTTP 프로토콜 5000포트 사용
    - Health Check를 통해 연결 상태 확인

## 수동으로 추가하기
1. 로드 밸런싱 대상 그룹 (Target Group)으로 이동
2. 대상 그룹 리스트 확인 및 선택
3. 인스턴스 확인 후 추가

## 자동으로 추가하기
1. AMI 만들기 (베이스 이미지 만들기)
    
    i) 해당 인스턴스에서 `우클릭` > `이미지 및 템플릿` > `이미지 생성`

    ii) 이미지 명 입력 후 생성

    iii) EC2메뉴 > `이미지`> `AMI`에서 생성 확인
2. Auto Scaling 시작 구성 생성

    i) EC2 메뉴 > `Auto Scaling` > `시작구성` > 시작구성 생성

    ii) AMI에 생성한 이미지 추가

    iii) 보안 그룹은 기존 EC2와 동일하게

3. Auto Scaling 그룹 만들기

    i) EC2 메뉴 > `Auto Scaling` > `Auto Scaling 그룹` > 생성
    
    ii) `시작 템플릿으로 전환` 후 시작 구성 추가

    iii) 네트워크 설정 (서브넷 : a-c, b-d)

    iv) 기존 load balancer에 연결 후 해당 타켓그룹 지정

4. 인스턴스 Health check
    - 대상 그룹 리스트 health check
    - unhealthy 일 경우 생성 과정에서 인스턴스에서 돌고있던 서버가 죽는 경우가 많음 **콘솔로 인스턴스 접속하여 정상작동하는지 꼭 확인하기**